'use strict';window.tsfem_inpost=function(a){const b=tsfem_inpostL10n.post_ID,c=tsfem_inpostL10n.nonce,d=tsfem_inpostL10n.rlt,e=tsfem_inpostL10n.isPremium,f=tsfem_inpostL10n.locale,g=tsfem_inpostL10n.debug,h=tsfem_inpostL10n.i18n;var i;const j=e=>{const f=(b,c)=>{let d=a(c),e=d.children(".tsf-notice, #tsfem-notice-wrap .notice");1<e.length&&e.slice(0,e.length-1).each(function(){a(this).slideUp(200,function(){this.remove()})}),a(b).hide().appendTo(d).slideDown(200);let f=a(".tsfem-flex-settings-notification-area .tsf-dismiss");const g=b=>{a(b.target).closest(".tsf-notice").slideUp(200,function(){this.remove()})};f.off("click",g).on("click",g)},h=(e,f)=>{let h=a.Deferred(),i=f?1:0,j="";return a.ajax({method:"POST",url:ajaxurl,datatype:"json",data:{action:"tsfem_inpost_get_dismissible_notice",post_ID:b,nonce:c,"tsfem-notice-key":e,"tsfem-notice-has-msg":i},timeout:7e3,async:!0}).done(b=>{b=tsf.convertJSONResponse(b),g&&void 0;let c=b?.data,e=b?.type;if(!c||!e||"undefined"==typeof c.notice);else{let b="";i?(b=a(c.notice),d?b.find("p").first().prepend(`${f} `):b.find("p").first().append(` ${f}`)):b=c.notice,j=b}}).fail(()=>{tsf.l10n.states.debug&&(void 0);let a=i?wp.template("tsfem-inpost-notice-error"):wp.template("tsfem-inpost-notice-5xx"),b=a({code:e,msg:f});j=b}).always(()=>{h.resolve(j)}),h.promise()};return{in:a=>{if(e){if(i)return void setTimeout(()=>{j(e).in(a)},500);i=!0;let b=e.type||"error",c=e.code||void 0,d=e.text||"";if(void 0===c)h(-1,d).always(b=>{f(b,a),i=!1});else if(""===d)h(c,"").always(b=>{f(b,a),i=!1});else{let g=wp.template(`tsfem-inpost-notice-${b}`);e=g({code:c,msg:d}),f(e,a),i=!1}}}}},k=(a,b,c)=>{tsf.l10n.states.debug&&(void 0,void 0);let d="";switch(c){case"abort":case"timeout":d=h.TimeoutError;break;case"Bad Request":d=h.BadRequest;break;case"Internal Server Error":d=h.FatalError;break;case"parsererror":d=h.ParseError;break;default:d=h.UnknownError;}return d},l=(a,b)=>{if(a instanceof NodeList)return void a.forEach(a=>l(a,b));if(a&&!(!a instanceof Element)){["edit","loading","unknown","error","bad","warning","okay","good"].forEach(d=>{a.classList.remove(`tsfem-e-inpost-icon-${d}`),d===b&&a.classList.add(`tsfem-e-inpost-icon-${d}`)})}};var m={},n={};const o=(a,b,c,d)=>{var e=Number.parseFloat;if(!a||!a instanceof HTMLElement)return;a.style.willChange="opacity";let f=!1,g=!1;"function"==typeof c?(f=c,g=!0):"object"==typeof c&&(f=c?.cb||!1,g=c?.promise||!1),b||=250,d=!(void 0!==d)||d;let h,i,j,k=a.dataset.tsfemFadeId||"_"+Math.random().toString(22).substring(2,10)+Math.random().toString(22).substring(2,10),l=0;a.dataset.tsfemFadeId=k,"undefined"!=typeof m[k]&&(cancelAnimationFrame(m[k].frame),"show"===m[k].type?(a.style.opacity=1,a.style.display=null):(a.style.opacity=0,a.style.display="none"),delete m[k],"undefined"!=typeof n[k]&&n[k].resolve(),delete n[k]),g&&f&&(n[k]=new Promise,(()=>{n[k].then(()=>{delete n[k],f()})})(f)),m[k]={type:d?"show":"hide",frame:void 0},d?(a.style.display=null,a.style.opacity=0,h=c=>{i=void 0===i?c:i,j=(c-i)/b,l=+e(j).toPrecision(3),a.style.opacity=l,1<=l?(cancelAnimationFrame(m[k].frame),a.style.opacity=1,a.style.display=null,a.style.willChange="auto",delete a.dataset.tsfemFadeId,delete m[k],g?n?.[k].resolve():f&&f()):m[k].frame=requestAnimationFrame(h)}):(a.style.display=null,a.style.opacity=1,h=c=>{i=void 0===i?c:i,j=(c-i)/b,l=+e(1-j).toPrecision(3),a.style.opacity=l,a.style.display=null,0>=l?(cancelAnimationFrame(m[k].frame),a.style.opacity=0,a.style.display="none",a.style.willChange="auto",delete a.dataset.tsfemFadeId,delete m[k],g?n?.[k].resolve():f&&f()):m[k].frame=requestAnimationFrame(h)}),m[k].frame=requestAnimationFrame(h)};return Object.assign({load:()=>{}},{postID:b,nonce:c,isPremium:e,locale:f,debug:g,i18n:h},{isActionableElement:a=>!(!a instanceof HTMLElement)&&(a instanceof HTMLInputElement||a instanceof HTMLSelectElement||a instanceof HTMLLabelElement||a instanceof HTMLButtonElement||a instanceof HTMLTextAreaElement),escapeStr:(a,b)=>a.length?b?a.replace(/[&<>]/g,a=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[a]):a.replace(/[&<>"']/g,a=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"})[a]):"",promiseLoop:(a,b,c,d=2e3)=>new Promise((e,f)=>{let g=a.length;if(!g)return e();const h=i=>{let j,k,l;d&&(k=setTimeout(()=>{clearTimeout(j),l=setTimeout(()=>{f()},250)},d)),j=setTimeout(()=>new Promise(async(c,d)=>{try{await b(a[i]),c()}catch(a){d()}}).then(()=>{if(d&&(clearTimeout(k),l)){if(i<g)return;clearTimeout(l)}++i===g?e():(j=null,h(i))}).catch(()=>{f()}),c)};h(0)}),doAjax:(b,c)=>new Promise((d,f)=>{let i,l=c.noticeArea,m=c.premium||!1;return m&&!e?f():void(g&&void 0,a.ajax(b).done(a=>{a=tsf.convertJSONResponse(a),g&&void 0;let b=a?.data,c=a?.type;if(!b||!c)return i={type:"error",code:-1,text:h.InvalidResponse},void f();let e=b?.results?.code,j=b?.results?.notice,k=b?.results?.type;e&&k&&(i={type:k,code:e,text:j}),"success"===c&&"data"in b?d(b.data):f(e)}).fail((a,b,c)=>{tsf.l10n.states.debug&&(void 0,void 0),i={type:"error",code:-1,text:k(a,b,c)},f()}).always(()=>{i&&j(i).in(l)}))}),setFlexNotice:j,getAjaxError:k,setIconClass:l,fadeOut:(a,b,c)=>{o(a,b,c,!1)},fadeIn:o})}(jQuery),window.tsfem_inpost.load();
